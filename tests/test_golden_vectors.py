from tools.gs1_codec import make_metadata_record_cbor, to_hex, encode_canonical_cbor
from typing import Dict

SAMPLE_AGRICULTURE_AI_MAP: Dict[int, str] = {
    1: "12341234567893",
    10: "ABC12345",
    17: "241122",
    30: "50"
}

SAMPLE_LOGISTICS_AI_MAP: Dict[int, str] = {
    0: "003456789012345678",
    1: "12341234567893",
    10: "ABC12345",
    413: "1234567890123",
    414: "9876543210987"
}

SAMPLE_RETAIL_AI_MAP: Dict[int, str] = {
    1: "12341234567893",
    10: "ABC12345",
    414: "9876543210987",
    8004: "12345678901234567890"
}

def test_agriculture_envelope_hex():
    env = make_metadata_record_cbor(SAMPLE_AGRICULTURE_AI_MAP)

    actual = to_hex(encode_canonical_cbor(env))
    expected = "a11a09bf4ceea4677061796c6f6164a46230316e313233343132333435363738393362313068414243313233343562313766323431313232623330623530687374616e64617264636773316b6773315f72656c656173656432342e306e736368656d615f76657273696f6e65312e302e30"  # paste once after generating
    assert actual == expected


def test_agriculture_cbor_ai_map():

    expected = "a4016e31323334313233343536373839330a6841424331323334351166323431313232181e623530"
    assert to_hex(encode_canonical_cbor(SAMPLE_AGRICULTURE_AI_MAP)) == expected

def test_logistics_envelope_hex():
    env = make_metadata_record_cbor(SAMPLE_LOGISTICS_AI_MAP)

    actual = to_hex(encode_canonical_cbor(env))
    expected = "a11a09bf4ceea4677061796c6f6164a5623030723030333435363738393031323334353637386230316e3132333431323334353637383933623130684142433132333435633431336d31323334353637383930313233633431346d39383736353433323130393837687374616e64617264636773316b6773315f72656c656173656432342e306e736368656d615f76657273696f6e65312e302e30"
    assert actual == expected

def test_logistics_cbor_ai_map():

    expected = "a50072303033343536373839303132333435363738016e31323334313233343536373839330a68414243313233343519019d6d3132333435363738393031323319019e6d39383736353433323130393837"
    assert to_hex(encode_canonical_cbor(SAMPLE_LOGISTICS_AI_MAP)) == expected

def test_retail_envelope_hex():
    env = make_metadata_record_cbor(SAMPLE_RETAIL_AI_MAP)

    actual = to_hex(encode_canonical_cbor(env))
    expected = "a11a09bf4ceea4677061796c6f6164a46230316e3132333431323334353637383933623130684142433132333435633431346d393837363534333231303938376438303034743132333435363738393031323334353637383930687374616e64617264636773316b6773315f72656c656173656432342e306e736368656d615f76657273696f6e65312e302e30"
    assert actual == expected

def test_retail_cbor_ai_map():

    expected = "a4016e31323334313233343536373839330a68414243313233343519019e6d39383736353433323130393837191f44743132333435363738393031323334353637383930"
    assert to_hex(encode_canonical_cbor(SAMPLE_RETAIL_AI_MAP)) == expected